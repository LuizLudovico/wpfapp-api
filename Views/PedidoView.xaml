<UserControl x:Class="WpfApp.Views.PedidoView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:WpfApp.ViewModels"
             Background="White">
    <UserControl.Resources>
        <vm:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </UserControl.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- TÃ­tulo -->
        <TextBlock Grid.Row="0" Text="ðŸ“‹ Gerenciamento de Pedidos" 
                   FontSize="24" FontWeight="Bold" 
                   Foreground="#2C3E50" Margin="0,0,0,20"/>

        <!-- Filtros e BotÃµes de AÃ§Ã£o -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- Filtros -->
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock Text="Filtrar por:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="Bold"/>
                <ComboBox Width="150" SelectedItem="{Binding FiltroSelecionado}">
                    <ComboBoxItem Content="Todos" IsSelected="True"/>
                    <ComboBoxItem Content="Pendentes"/>
                    <ComboBoxItem Content="Pagos"/>
                    <ComboBoxItem Content="Enviados"/>
                    <ComboBoxItem Content="Recebidos"/>
                </ComboBox>
            </StackPanel>
            
            <!-- BotÃµes de AÃ§Ã£o -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="âž• Novo Pedido" Command="{Binding NovoPedidoCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="âœ… Finalizar" Command="{Binding FinalizarCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ’° Marcar Pago" Command="{Binding MarcarComoPagoCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ“¦ Marcar Enviado" Command="{Binding MarcarComoEnviadoCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="âœ… Marcar Recebido" Command="{Binding MarcarComoRecebidoCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ—‘ï¸ Excluir" Command="{Binding ExcluirCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
            </StackPanel>
        </Grid>

        <!-- Lista e Detalhes -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <!-- Lista de Pedidos -->
            <DataGrid Grid.Column="0" 
                      ItemsSource="{Binding Pedidos}"
                      SelectedItem="{Binding PedidoSelecionado}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      Style="{StaticResource DataGridStyle}"
                      Margin="0,0,10,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Data" Binding="{Binding DataVenda, StringFormat=dd/MM/yyyy}" Width="Auto"/>
                    <DataGridTextColumn Header="Cliente" Binding="{Binding NomeCliente}" Width="*"/>
                    <DataGridTextColumn Header="Valor" Binding="{Binding ValorTotal, StringFormat=C}" Width="Auto"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="Auto"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Detalhes do Pedido -->
            <Border Grid.Column="1" BorderBrush="#BDC3C7" BorderThickness="1" 
                    Padding="15" CornerRadius="5">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel DataContext="{Binding PedidoSelecionado}">
                        <TextBlock Text="Detalhes do Pedido" FontSize="16" 
                                   FontWeight="Bold" Margin="0,0,0,15"/>

                        <TextBlock Text="Cliente:"/>
                        <TextBox Text="{Binding NomeCliente, Mode=OneWay}" 
                                 IsReadOnly="True" Margin="0,0,0,10"/>

                        <TextBlock Text="Data da Venda:"/>
                        <TextBox Text="{Binding DataVenda, StringFormat=dd/MM/yyyy HH:mm, Mode=OneWay}" 
                                 IsReadOnly="True" Margin="0,0,0,10"/>

                        <TextBlock Text="Forma de Pagamento:"/>
                        <ComboBox SelectedValue="{Binding FormaPagamento}" 
                                  IsEnabled="{Binding DataContext.PedidoPodeSerEditado, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                  Margin="0,0,0,10">
                            <ComboBoxItem Content="Dinheiro" Tag="0"/>
                            <ComboBoxItem Content="PIX" Tag="1"/>
                            <ComboBoxItem Content="CartÃ£o" Tag="2"/>
                            <ComboBoxItem Content="Boleto" Tag="3"/>
                        </ComboBox>

                        <TextBlock Text="Status:"/>
                        <TextBox Text="{Binding Status, Mode=OneWay}" 
                                 IsReadOnly="True"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Valor Total:"/>
                        <TextBox Text="{Binding ValorTotal, StringFormat=C, Mode=OneWay}" 
                                 IsReadOnly="True" FontWeight="Bold" 
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="ObservaÃ§Ãµes:"/>
                        <TextBox Text="{Binding Observacoes, UpdateSourceTrigger=PropertyChanged}" 
                                 Height="80" TextWrapping="Wrap" 
                                 AcceptsReturn="True"
                                 IsReadOnly="{Binding DataContext.PedidoPodeSerEditado, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource InverseBooleanConverter}}"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Itens do Pedido:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <DataGrid ItemsSource="{Binding Itens}"
                                  AutoGenerateColumns="False"
                                  Height="200">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Produto" Binding="{Binding NomeProduto}" Width="*"/>
                                <DataGridTextColumn Header="Qtd" Binding="{Binding Quantidade}" Width="50"/>
                                <DataGridTextColumn Header="PreÃ§o Un." Binding="{Binding PrecoUnitario, StringFormat=C}" Width="Auto"/>
                                <DataGridTextColumn Header="Subtotal" Binding="{Binding Subtotal, StringFormat=C}" Width="Auto"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>

