<UserControl x:Class="WpfApp.Views.PessoaView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:WpfApp.ViewModels"
             Background="White">
    <UserControl.Resources>
        <vm:DateConverter x:Key="DateConverter"/>
    </UserControl.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- TÃ­tulo -->
        <TextBlock Grid.Row="0" Text="ðŸ‘¤ Cadastro de Pessoas" 
                   FontSize="24" FontWeight="Bold" 
                   Foreground="#2C3E50" Margin="0,0,0,20"/>

        <!-- Filtro e BotÃµes -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock Text="Filtrar por:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="Bold"/>
                <ComboBox Width="120" 
                          SelectedValue="{Binding TipoFiltroSelecionado}"
                          SelectedValuePath="Content"
                          Margin="0,0,10,0">
                    <ComboBoxItem Content="Nome" IsSelected="True"/>
                    <ComboBoxItem Content="CPF"/>
                </ComboBox>
                <TextBox Width="300" 
                         Text="{Binding ValorFiltro, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource SearchTextBoxStyle}"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="âž• Incluir" Command="{Binding AdicionarCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="âœï¸ Editar" Command="{Binding EditarCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ’¾ Salvar" Command="{Binding SalvarCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ—‘ï¸ Excluir" Command="{Binding ExcluirCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="ðŸ“‹ Incluir Pedido" Command="{Binding IncluirPedidoCommand}" 
                        Style="{StaticResource ActionButtonStyle}"/>
            </StackPanel>
        </Grid>

        <!-- Lista e Detalhes -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <!-- Lista de Pessoas -->
            <DataGrid Grid.Column="0" 
                      ItemsSource="{Binding Pessoas}"
                      SelectedItem="{Binding PessoaSelecionada}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      Style="{StaticResource DataGridStyle}"
                      Margin="0,0,10,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Nome" Binding="{Binding Nome}" Width="*"/>
                    <DataGridTextColumn Header="CPF" Binding="{Binding CPF}" Width="Auto"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Detalhes da Pessoa -->
            <Border Grid.Column="1" BorderBrush="#BDC3C7" BorderThickness="1" 
                    Padding="15" CornerRadius="5">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel DataContext="{Binding PessoaSelecionada}">
                        <TextBlock Text="Detalhes da Pessoa" FontSize="16" 
                                   FontWeight="Bold" Margin="0,0,0,15"/>

                        <TextBlock Text="Nome:"/>
                        <TextBox Text="{Binding Nome, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="CPF:"/>
                        <TextBlock Text="Exemplo: 001.001.001-00" FontSize="10" Foreground="Gray" Margin="0,0,0,2"/>
                        <TextBox x:Name="TxtCPF" 
                                 Text="{Binding CPF, UpdateSourceTrigger=PropertyChanged}" 
                                 TextChanged="TxtCPF_TextChanged"
                                 MaxLength="14"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Email:"/>
                        <TextBox x:Name="TxtEmail"
                                 Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}" 
                                 LostFocus="TxtEmail_LostFocus"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Telefone:"/>
                        <TextBlock Text="Exemplo: (11)99999-9999 ou (11)3333-2222" FontSize="10" Foreground="Gray" Margin="0,0,0,2"/>
                        <TextBox x:Name="TxtTelefone"
                                 Text="{Binding Telefone, UpdateSourceTrigger=PropertyChanged}" 
                                 TextChanged="TxtTelefone_TextChanged"
                                 MaxLength="15"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="Data de Nascimento:"/>
                        <TextBlock Text="Exemplo: 01/01/1900" FontSize="10" Foreground="Gray" Margin="0,0,0,2"/>
                        <TextBox x:Name="TxtDataNascimento"
                                 Text="{Binding DataNascimento, Converter={StaticResource DateConverter}, UpdateSourceTrigger=LostFocus}"
                                 TextChanged="TxtDataNascimento_TextChanged"
                                 LostFocus="TxtDataNascimento_LostFocus"
                                 MaxLength="10"
                                 Margin="0,0,0,10"/>

                        <TextBlock Text="EndereÃ§o:"/>
                        <TextBlock Text="Exemplo: Rua ABC, 123, Centro - Cidade/SP" FontSize="10" Foreground="Gray" Margin="0,0,0,2"/>
                        <TextBox Text="{Binding Endereco, UpdateSourceTrigger=PropertyChanged}" 
                                 Height="50" 
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"
                                 Margin="0,0,0,15"/>
                        
                        <!-- Grid de Pedidos da Pessoa -->
                        <TextBlock Text="Pedidos da Pessoa:" FontWeight="Bold" Margin="0,10,0,5"/>
                        
                        <!-- Filtro de Pedidos -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="Filtrar pedidos:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Width="150" 
                                      SelectedValue="{Binding FiltroPedidosDaPessoa}"
                                      SelectedValuePath="Content">
                                <ComboBoxItem Content="Todos" IsSelected="True"/>
                                <ComboBoxItem Content="Pendentes"/>
                                <ComboBoxItem Content="Pagos"/>
                                <ComboBoxItem Content="Enviados"/>
                                <ComboBoxItem Content="Recebidos"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <DataGrid ItemsSource="{Binding PedidosDaPessoa}"
                                  SelectedItem="{Binding PedidoDaPessoaSelecionado}"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  Height="150"
                                  Margin="0,0,0,5">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Data" Binding="{Binding DataVenda, StringFormat=dd/MM/yyyy}" Width="Auto"/>
                                <DataGridTextColumn Header="Valor" Binding="{Binding ValorTotal, StringFormat=C}" Width="Auto"/>
                                <DataGridTextColumn Header="Forma Pgto" Binding="{Binding FormaPagamento}" Width="Auto"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <!-- AÃ§Ãµes do Pedido Selecionado -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Button Content="ðŸ’° Pago" Command="{Binding DataContext.MarcarPedidoComoPagoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    Background="#27AE60" Foreground="White" Padding="8,4" Margin="0,0,5,0" BorderThickness="0" Cursor="Hand"/>
                            <Button Content="ðŸ“¦ Enviado" Command="{Binding DataContext.MarcarPedidoComoEnviadoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    Background="#3498DB" Foreground="White" Padding="8,4" Margin="0,0,5,0" BorderThickness="0" Cursor="Hand"/>
                            <Button Content="âœ… Recebido" Command="{Binding DataContext.MarcarPedidoComoRecebidoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    Background="#2ECC71" Foreground="White" Padding="8,4" Margin="0,0,5,0" BorderThickness="0" Cursor="Hand"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>

